<h1>Domain Information Groper</h1>

<div class="lookup-form">
  <%= turbo_frame_tag "domain_form" do %>
    <%= form_with url: dig_lookup_path, method: :post, local: true do %>
      <div class="form-group-inline">
        <%= label_tag :domain, "Enter Domain:", class: "form-label-inline" %>
        <%= text_field_tag :domain, nil, class: "form-input-inline" %>
        <%= submit_tag "Lookup", class: "btn btn-lookup-inline", style: "background-color: #007bff; color: #fff; padding: 8px 16px; border: none; border-radius: 5px; cursor: pointer;" %>
      </div>
    <% end %>
  <% end %>
</div>

<%= turbo_frame_tag "results" do %>
  <div id="results">
    <% if @error.present? %>
      <p class="error"><%= @error %></p>
    <% end %>
    <% if @results.present? %>
      <h2>Results for <%= @domain %>:</h2>
      <% @results.each do |type, results| %>
        <h3><%= type %> Records:</h3>
        <% if results.is_a?(String) %>
          <p class="error"><%= results %></p>
        <% elsif results.any? %>
          <ul>
            <% results.each do |result| %>
              <li>
                <% case type %>
                <% when "A", "AAAA" %>
                  <%= result.address %>
                <% when "CNAME", "PTR" %>
                  <%= result.name.to_s %>
                <% when "NS" %>
                  <%= result.domainname.to_s %>
                <% when "MX" %>
                  <%= result.exchange.to_s %> (Preference: <%= result.preference %>)
                <% when "TXT" %>
                  <%= result.strings.join(" ") %>
                <% else %>
                  <%= result.inspect %>
                <% end %>
              </li>
            <% end %>
          </ul>
        <% else %>
          <p>No <%= type %> records found.</p>
        <% end %>
      <% end %>
      <%= form_with url: dig_clear_path, method: :post, local: true do %>
        <div class="button-group">
          <%= submit_tag "Clear", class: "btn btn-clear" %>
        </div>
      <% end %>
    <% else %>
      <p>No results found.</p>
    <% end %>
  </div>
<% end %>